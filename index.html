<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مخطط رمضان V8 | Ramadan Planner</title> <meta name="theme-color" content="#1e293b">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #0f172a; color: #f8fafc; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        .glass-panel { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .task-input { background: transparent; border: none; border-bottom: 1px solid #334155; color: #e2e8f0; width: 100%; padding: 4px 0; outline: none; transition: 0.3s; }
        .task-input:focus { border-bottom-color: var(--theme-color, #fbbf24); }
        .custom-checkbox input:checked + div { background-color: #10b981; border-color: #10b981; }
        
        /* Grades */
        .grade-A { border-color: #4ade80 !important; box-shadow: 0 0 10px rgba(74, 222, 128, 0.2); }
        .grade-B { border-color: #60a5fa !important; }
        .grade-C { border-color: #facc15 !important; }
        .grade-D { border-color: #fb923c !important; }
        .grade-F { border-color: #f87171 !important; }

        /* Modals */
        .modal { opacity: 0; pointer-events: none; transition: 0.3s; z-index: 100; }
        .modal.active { opacity: 1; pointer-events: all; }
        .modal-content { transform: scale(0.95); transition: 0.3s; }
        .modal.active .modal-content { transform: scale(1); }
        
        /* Animation */
        @keyframes pulse-gold {
            0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
            100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); }
        }
        .day-complete { animation: pulse-gold 2s infinite; border-color: #fbbf24 !important; }

        /* Color Menu Animation */
        #color-menu { transition: all 0.2s ease-in-out; transform-origin: top left; }
        #color-menu.hidden { transform: scale(0.95); opacity: 0; pointer-events: none; }
        #color-menu.block { transform: scale(1); opacity: 1; pointer-events: auto; }
    </style>
</head>
<body class="min-h-screen flex flex-col transition-colors duration-500" onclick="closeMenus(event)">

    <header class="bg-[#1e293b] border-b border-gray-700 sticky top-0 z-40 shadow-xl">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-4">
                <div class="flex items-center gap-3">
                    <div id="logo-icon" class="w-10 h-10 rounded-lg flex items-center justify-center bg-yellow-500 text-white text-xl shadow-lg transition-colors duration-300">
                        <i class="fas fa-moon"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">مخطط رمضان V8</h1>
                        <div id="countdown" class="text-[10px] text-green-400 font-mono">...</div>
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 justify-center">
                    <button onclick="showHadith()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded text-xs transition border border-gray-600 flex items-center gap-1">
                        <i class="fas fa-lightbulb text-yellow-400"></i> حديث
                    </button>
                    <button onclick="showChart()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded text-xs transition border border-gray-600 flex items-center gap-1">
                        <i class="fas fa-chart-line text-blue-400"></i> تحليل
                    </button>
                    
                    <div class="relative">
                        <button onclick="toggleColorMenu(event)" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded text-xs transition border border-gray-600 flex items-center gap-1">
                            <i class="fas fa-palette text-pink-400"></i> ألوان
                        </button>
                        <div id="color-menu" class="absolute left-0 mt-2 w-48 bg-[#1e293b] border border-gray-600 rounded-xl shadow-2xl hidden p-4 z-50">
                            <p class="text-xs text-gray-400 mb-2 text-center">اختر لون الثيم:</p>
                            <div class="grid grid-cols-5 gap-3">
                                <div onclick="setTheme('gold')" class="w-6 h-6 rounded-full bg-yellow-500 cursor-pointer ring-2 ring-transparent hover:ring-white transition" title="ذهبي"></div>
                                <div onclick="setTheme('blue')" class="w-6 h-6 rounded-full bg-blue-500 cursor-pointer ring-2 ring-transparent hover:ring-white transition" title="أزرق"></div>
                                <div onclick="setTheme('green')" class="w-6 h-6 rounded-full bg-emerald-500 cursor-pointer ring-2 ring-transparent hover:ring-white transition" title="أخضر"></div>
                                <div onclick="setTheme('purple')" class="w-6 h-6 rounded-full bg-purple-500 cursor-pointer ring-2 ring-transparent hover:ring-white transition" title="بنفسجي"></div>
                                <div onclick="setTheme('rose')" class="w-6 h-6 rounded-full bg-rose-500 cursor-pointer ring-2 ring-transparent hover:ring-white transition" title="وردي"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="exportData()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded text-xs transition border border-gray-600">
                        <i class="fas fa-download"></i>
                    </button>
                    <label class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded text-xs transition border border-gray-600 cursor-pointer">
                        <i class="fas fa-upload"></i>
                        <input type="file" onchange="importData(this)" class="hidden">
                    </label>
                    <button onclick="resetData()" class="bg-red-900/30 hover:bg-red-900/50 text-red-400 px-3 py-1.5 rounded text-xs transition border border-red-900/50">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-3 gap-3">
                <div class="glass-panel p-2 rounded-lg relative overflow-hidden">
                    <div class="flex justify-between items-center relative z-10 text-xs text-gray-300">
                        <span>القرآن</span> <i class="fas fa-book-open"></i>
                    </div>
                    <div class="text-lg font-bold text-white relative z-10 mt-1"><span id="quran-stat">0</span>/30</div>
                    <div id="quran-bar" class="absolute bottom-0 left-0 h-1 bg-yellow-500 transition-all duration-1000" style="width:0%"></div>
                </div>
                <div class="glass-panel p-2 rounded-lg relative overflow-hidden">
                    <div class="flex justify-between items-center relative z-10 text-xs text-gray-300">
                        <span>الصلاة</span> <i class="fas fa-mosque"></i>
                    </div>
                    <div class="text-lg font-bold text-white relative z-10 mt-1"><span id="prayer-stat">0</span>%</div>
                    <div id="prayer-bar" class="absolute bottom-0 left-0 h-1 bg-green-500 transition-all duration-1000" style="width:0%"></div>
                </div>
                <div class="glass-panel p-2 rounded-lg relative overflow-hidden">
                    <div class="flex justify-between items-center relative z-10 text-xs text-gray-300">
                        <span>المهام</span> <i class="fas fa-tasks"></i>
                    </div>
                    <div class="text-lg font-bold text-white relative z-10 mt-1"><span id="task-stat">0</span>%</div>
                    <div id="task-bar" class="absolute bottom-0 left-0 h-1 bg-blue-500 transition-all
